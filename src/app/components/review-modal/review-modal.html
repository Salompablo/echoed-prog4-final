<div class="modal-backdrop" (click)="onBackdropClick($event)">
  <div class="modal-content">
    <button type="button" class="close-button" (click)="onCancel()" aria-label="Close modal">
      Ã—
    </button>

    <div class="modal-body">
      <div class="content-wrapper">
        <div class="left-section">
          <img [src]="item().imageUrl" [alt]="displayTitle()" class="item-image" />

          <div class="item-metadata">
            <h2 class="item-title">{{ displayTitle() }}</h2>
            <p class="item-artist">{{ displayArtist() }}</p>
            @if (isSong() && songItem()) {
            <p class="item-album">{{ songItem()!.albumName }}</p>
            }
            <p class="item-year">{{ displayYear() }}</p>
          </div>
        </div>

        <div class="right-section">
          <form [formGroup]="reviewForm" (ngSubmit)="onSubmit()" class="review-form">
            <div class="form-group rating-group">
              <app-star-rating formControlName="rating"></app-star-rating>
              @if (rating?.invalid && rating?.touched) {
              <span class="error-message">{{"review-modal.rating" | translate}}</span>
              }
            </div>

            <div class="form-group">
              <label for="description">{{"review-modal.echo" | translate}}</label>
              <textarea id="description" formControlName="description"
                [placeholder]="'review-modal.description-placeholder' | translate" rows="5"
                [maxlength]="MAX_CHARS"></textarea>

              <div class="character-counter" [class.invalid]="!isCharCountValid()">
                {{ characterCount() }} / {{ MAX_CHARS }}
                @if (characterCount() < MIN_CHARS) { <span class="hint">{{ "review-modal.min-hint" | translate:
                  {MIN_CHARS: MIN_CHARS} }}</span>
                  }
              </div>

              @if (description?.invalid && description?.touched) {
              <span class="error-message">
                @if (description?.errors?.['required']) {
                {{"review-modal.description-required" | translate}}
                }
                @if (description?.errors?.['minlength']) {
                {{ "review-modal.minlength" | translate: {MIN_CHARS: MIN_CHARS} }}
                }
              </span>
              }
            </div>

            <div class="modal-actions">
              <button type="button" class="button secondary" (click)="onCancel()" [disabled]="isSubmitting()">
                {{"review-modal.cancel" | translate}}
              </button>
              <button type="submit" class="button primary" [disabled]="reviewForm.invalid || isSubmitting()">
                {{
                isSubmitting()
                ? ("review-modal.submitting" | translate)
                : (isEditMode() ? ("review-modal.update" | translate) : ("review-modal.submit" | translate))
                }}

              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>