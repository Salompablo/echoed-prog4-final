<div class="register-container">
    <h2>{{"register.title" | translate}}</h2>
    <p class="subtitle">{{"register.subtitle" | translate}}</p>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">

        <div class="form-group">
            <label for="email">{{"register.email" | translate}}</label>
            <input type="email" id="email" formControlName="email" />

            @if (email?.invalid && (email?.dirty || email?.touched)) {
            <div class="error-validation">
                @if (email?.errors?.['required']) {
                <small>{{"register.email-required" | translate}}</small>
                }
                @if (email?.errors?.['email']) {
                <small>{{"register.email-invalid" | translate}}</small>
                }
            </div>
            }
        </div>

        <div class="form-group">
            <label for="username">{{"register.username" | translate}}</label>
            <input type="text" id="username" formControlName="username" />

            @if (username?.invalid && (username?.dirty || username?.touched)) {
            <div class="error-validation">
                @if (username?.errors?.['required']) {
                <small>{{"register.username-required" | translate}}</small>
                }
                @if (username?.errors?.['minlength']) {
                <small>{{"register.username-minlength" | translate}}</small>
                }
                @if (username?.errors?.['maxlength']) {
                <small>{{"register.username-maxlength" | translate}}</small>
                }
                @if (username?.errors?.['pattern']){
                <small>{{"register.username-pattern" | translate}}</small>
                }
            </div>
            }
        </div>

        <div class="form-group">
            <label for="password">{{"register.password" | translate}}</label>

            <div class="password-input-wrapper">
                <input [type]="passwordsHidden ? 'password' : 'text'" id="password" formControlName="password" />

                <button type="button" class="toggle-password" (click)="togglePasswordVisibility()">

                    @if (passwordsHidden) {
                    <span>{{"register.show" | translate}}</span>
                    } @else {
                    <span>{{"register.hide" | translate}}</span>
                    }
                </button>
            </div>

            @if (password?.invalid && (password?.dirty || password?.touched)) {
            <div class="error-validation">
                @if (password?.errors?.['required']) {
                <small>{{"register.password-required" | translate}}</small>
                }
                @if (password?.errors?.['minlength']) {
                <small>{{"register.password-minlength" | translate}}</small>
                }
                @if (password?.errors?.['maxlength']) {
                <small>{{"register.password-maxlength" | translate}}</small>
                }
            </div>
            }
        </div>

        <div class="form-group">
            <label for="confirmPassword">{{"register.confirm-password" | translate}}</label>
            <input [type]="passwordsHidden ? 'password' : 'text'" id="confirmPassword"
                formControlName="confirmPassword" />

            @if (confirmPassword?.invalid && (confirmPassword?.dirty || confirmPassword?.touched)) {
            <div class="error-validation">
                @if (confirmPassword?.errors?.['required']) {
                <small>{{"register.confirm-password-required" | translate}}</small>
                }
            </div>
            }
        </div>

        @if (registerForm.errors?.['passwordMismatch'] && confirmPassword?.touched) {
        <div class="error-validation">
            <small>{{"register.password-error" | translate}}</small>
        </div>
        }

        @if (errorMessage) {
        <div class="error-api">
            {{ errorMessage }}
        </div>
        }

        <button type="submit" [disabled]="registerForm.invalid || isLoading()">
            @if (isLoading()) {
                <span class="button-spinner"></span> {{"register.loading" | translate}}
            } @else {
                {{"register.sign-up" | translate}}
            }
        </button>

        <div class="separator">{{"register.continue-with" | translate}}</div>
        <div class="oauth-buttons">
            <a [href]="googleOAuthUrl" class="oauth-btn google">


                <img src="/assets/google-logo.svg" alt="Google logo" class="oauth-icon" /> Google </a>
        </div>
    </form>

    <div class="redirect-link">{{"register.existing-account" | translate}} <a href="/login">Sign In</a>
    </div>
</div>